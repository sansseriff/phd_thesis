## The differential readout and impedance matching taper design for SNSPDs

Superconducting nanowire single-photon detectors (SNSPDs) offer high efficiency, low dark count rates, high count rates, and low timing jitter. However, traditional SNSPD designs face challenges in achieving both high detection efficiency and low jitter, especially for large-area detectors. Marco Colangelo et al. [@Colangelo2023] proposed a new device design for SNSPDs that combines differential readout and impedance matching tapers to overcome these challenges. This design enables high detection efficiency and low jitter simultaneously along with pixel-level imaging capabilities and photon-number resolution.

Detectors of the type demonstrated by Colangelo et al. have been fabricated at JPL (Fig. [1](#fig:diff) a) for the duration of this PhD research, and are used primarily for three projects detailed in this thesis: the low dark count rate project, the position modulation and photon number resolution project, and the high rate entanglement project. Given the significance of the differential tapered SNSPD to much of this PhD research, it’s key design design and performance features are reviewed here.

<figure markdown> 
    <a name='fig:diff'></a> 
    <img alt="fig:diff" style="width: nil; margin: auto;" src="../figs/diff_light.png#only-light" >
    <img alt="fig:diff" style="width: nil; margin: auto;" src="../figs/diff_dark.png#only-dark" > 
    <figcaption markdown> Figure 1: **Differential Single Pixel** a) Two packaged differential single pixel detectors. Coupled fibers highlighted in gree, differential SMA readout highlighted in red b) Magnified images of the detector lolipop-shape waver, highlighting where the tapers and efficiency-enhansing optical stack are located <span class=orange markdown>image source?</span> c) Integrated 2D histogram showing different heights and shapes of RF pulse rising edge in response to incident multi-photon optical pulses.</figcaption>
    </figure>

### Geometric jitter cancellation through differential readout

Two main types of jitter arise in high efficiency SNSPD designs; amplifier jitter and geometric jitter. Amplifier jitter is where the readout electrical noise impacts the timing jitter, while geometric jitter emerges from the propagation delays created by detection events at various locations along the nanowire meander. Nanowires made of thin-film materials exhibit high kinetic inductance and behave like transmission lines with high characteristic impedance and slow phase velocity. These transmission line properties result in pulse propagation delays that contribute to the timing jitter of the detector. The arrival time of voltage pulses from the detector to time tagging equipment depends on the location of photon absorption in the nanowire, as detections closer to the ground termination and farther from the single readout must travel farther at low phase velocity through the nanowire before exiting. For large detectors, geometric jitter can contribute tens of picoseconds to the total system jitter. As detector size is often correlated with coupling efficiency to a given optical mode, the use of single-ended readout implies a trade-off between system detection efficiency and jitter due to longitudinal geometric effects.

The implementation of a differential readout approach offers a solution to these issues. Instead of just isolating the positive voltage pulse , the negative pulse from the other end of the nanowire is also collected. Simple processing of both pulses reveals information about photon arrival time as well as photon arrival location.

If the measurements of arrival time $t_F$ and absorption location along the nanowire are both of interest, then the timing of the $t_{neg}$ negative and positive $t_{pos}$ voltage pulses may be read out with 2 time taggers or high-speed oscilloscope channels. The difference of arrival time $t_{pos} - t_{neg}$ of these signals constitutes the photon absorption location information, while the average $1/2(t_{pos} - t_{neg})$ of the arrival times constitutes the photon arrival time information. For practical single photon counting applications, however, the photon arrival time information is typically sufficient and real-time processing of two time tags per detection event is not practical. Therefore, a 2:1 balun transformer can be used to perform an equivalent hardware difference of the complementary pulses (analogous to the averaging of timetags $t_{pos}, t_{neg}$). After amplification, the two sides of the detector are connected to the differential inputs of the balun, with the output being sent to a TCSPC or equivalent time tagging module. The threshold voltage of the time tagger can be set to minimize the spread of time tag distribution, corresponding to the condition where the timing measurement $t_{tagger} \approx t_F$ so that the photon arrival location information is cancelled out.

### Increased SNR with impedance matching tapers

In a usual SNSPD, the nanowire exibits impedance on the order of $\mathrm{k} \Upomega$, while the readout circuit has an impedance of 50&#160;$\Upomega$. This mismatch can lead to RF pulses that exhibit reflections and distortions. These effects reduce slew rate and and lower Signal to Noise Ratio, bringing about higher amplifier jitter&#160;[@Korzh2020; @santavicca2019jitter].

The higher jitter that results from the impedance mismatch can be mitigated by designing the SNSPD to preserve the integrity of the output pulse. An impedance-matching taper interfacing the nanowire to the readout line can be integrated. Thanks to the gradual impedance transformation of a Klopfenstein style taper, the output pulse has a higher amplitude and a faster slew rate. In a toy snspd model developed by Colangelo et al.&#160;[@Colangelo2023], the incorporation of a taper increases pulse amplitude by a factor of 3.3.

Together the impedance matching tapers and differential readout work to reduce system jitter significant for large area meandered nanowires. For the research in this thesis, these detectors are usually used with a differencing balun for geometric jitter cancellation. The type fabricated at JPL typically have active areas of $22 \times 15 \ \mathrm{\upmu m}$, formed by a meander of 100 nm-wide and 5-nm-thick niobium nitride (NbN) nanowires on a 500 nm pitch (Fig. [1](#fig:diff) b). They are embedded in an efficiency-enhancing optical stack made of alternating layers of TiO$_2$ and SiO$_2$ and a gold mirror layer and typically have FWHM timing jitter of about 14 ps. The FW1%M jitter, which is a measure of the width of the jitter response function or histogram at 1% height, is an important metric for quantum or classical communication protocols that expect to reliably place photon timing measurements into time bins measured with respect to a clock. This is the case for pulsed Quantum Key Distribution and classical Pulse Position Modulation communication protocols.

Also, the use of impedance matching tapers can help distinguish between instances when one or multiple photons are absorbed in the nanowire on a short timescale (\< 100 ps). The absorption of different numbers of photons results in variations in RF pulse height and slew rate (Fig. [1](#fig:diff) c). This phenomenon gives the detector photon number resolution (PNR) whereby the specific number of photons in a optical pulse can be measured. This is in contrast to the more common binary detection capability offered by conventional SNSPDs that only indicates if one or more photons are absorbed. Chapter 4 explores how the manifestation of photon number resolution in this detector type presents a problem for accurate time correlated measurements of multi-photon light pulses.
